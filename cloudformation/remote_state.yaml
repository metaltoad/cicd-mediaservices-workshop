AWSTemplateFormatVersion: '2010-09-09'
Description: CloudFormation template for Terraform remote state resources

Resources:
  TerraformStateBucket:
    Type: AWS::S3::Bucket
    Properties:
      BucketName: !Sub 'terraform-remote-state-bucket-${AWS::AccountId}'
      VersioningConfiguration:
        Status: Enabled
      BucketEncryption:
        ServerSideEncryptionConfiguration:
          - ServerSideEncryptionByDefault:
              SSEAlgorithm: AES256

  TerraformStateLockTable:
    Type: AWS::DynamoDB::Table
    Properties:
      TableName: terraform-state-lock
      BillingMode: PAY_PER_REQUEST
      AttributeDefinitions:
        - AttributeName: LockID
          AttributeType: S
      KeySchema:
        - AttributeName: LockID
          KeyType: HASH

Outputs:
  StateBucketName:
    Description: Name of the S3 bucket for Terraform state
    Value: !Ref TerraformStateBucket
  LockTableName:
    Description: Name of the DynamoDB table for state locking
    Value: !Ref TerraformStateLockTable
  Region:
    Description: AWS Region where the resources are deployed
    Value: !Ref "AWS::Region"